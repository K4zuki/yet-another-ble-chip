# DA14580をもう少し詳しく
**`DA14580`** は送受信時5mAの低消費電力を売りにした、Bluetooth Low Energy
規格のトランシーバICです。送受信時5mAは業界最小消費電力^[2016-1-1現在]
らしいです。16MHz駆動のARM Cortex-M0マイクロコントローラ、SRAM 42kB,
ROM 84kB（ブートローダやBLEスタックが書かれている）、ワンタイムROM32kB、
そしてBLE送受信部を含めた周辺回路で構成されています。

## パッケージ
`DA14580`には３種類のパッケージがあります：

* **0.4ミリピッチWLCSP 34ボール(2.5x2.5mm) - DA14580-01UNA[^11]**
* **0.4ミリピッチQFN 40ピン(5.0x5.0mm) - DA14580-01AT2[^12]**
* **0.4ミリピッチQFN 48ピン(6.0x6.0mm) - DA14580-01A32[^13]**

WLCSPパッケージは外形が2.5ミリ角ですごく小さいです。
40/48ピンQFNは0.4ミリピッチなのでしんどいですがなんとか手ハンダできます。

## 周辺部品
`DA14580`は1.5V(単3電池)〜3.0V(コイン電池)のバッテリ電圧から内蔵昇降圧
レギュレータで内部電源を生成しますが、電源電圧で周辺部品のつなげ方が変わります。
いずれの場合も2.2uHのインダクタと1uFのセラミックコンデンサが必要です。
内部電源は1.4V程度なのでコンデンサの耐圧は10Vあれば十分です。1uFには
1005メトリック品なども使用可能と思います。

IO電圧は入力電圧に依存します。個人的にはよくある3.3V系のほうが
センサなどの周辺部品が多いと思うのでお勧めです。3.3V電源の場合IO電圧も3.3Vに
なります。___5VトレラントIOではありません___。5V系のIOに直結すると壊れます。
後述する`村田モジュール`は3.3V系につながるように設計されています。
また、WLCSPパッケージ品を内蔵していますので使用できるIOピンはWLCSPパッケージに
準拠します。

## 内蔵周辺回路(ペリフェラル)
ADコンバータは4チャネルまでで割当てピンは固定されていますが、UART、I^2^C、
SPIは自由に割り当てることができます。ロータリエンコーダも同様ですが、
2ピン1組で使うので制約があります。

* UART
    * UART,UART2
    * ハードウェアフロー制御もできる
    * 1MBaudまで
* GPIO
    * 最大14 (WLCSP34), 24 (QFN40), 32 (QFN48)個のGPIOピン
* I^2^C
    * 400kHzまで
* SPI
    * 8/9/16/32ビット・ワード
    * マスタ/スレーブ動作
    * 8MHzまで
* 10bit ADC
    * 4ch
* 汎用タイマー
    * Timer0
    * Timer2
    * SysTick
* キースキャナー
* ロータリエンコーダ・デコーダ（Quadrature decoder）

一通りのサンプルがSDK内の`'projects/target_apps/peripheral_examples/'`以下に用意されています。

\\newpage
## ピン機能一覧表

```table
---
# caption:
alignment: DCCCCCD
# table-width:
markdown: True
# inline markdown
include: data/pinout.csv
header: True
---
```

<!-- --- -->
[^11]: http://www.digikey.jp/product-detail/ja/DA14580-01UNA/1564-1012-1-ND/5113991
[^12]: http://www.digikey.jp/product-detail/ja/DA14580-01AT2/1564-1013-1-ND/5113990
[^13]: http://www.digikey.jp/product-detail/ja/DA14580-01A32/1564-1014-1-ND/5113994
[^14]: Nordicが送受信時5.5mAという新シリーズを出しちゃいました。その新シリーズで旧型番と互換性があるモジュールも登場しました。やばいです(迫真)
